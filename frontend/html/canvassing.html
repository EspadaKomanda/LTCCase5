<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/canvassing/canvassing.css">
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <title>Анкитирование</title>
</head>
<body>
    <header class="header">
        <h1 class="header__title">Пожалуйста, пройдите анкетирование, чтобы Ваш работодатель лучше узнал Вас</h1>
    </header>
    <main>
        <ol class="question__list">
            <li class="question__item question__item_selective">
                <h2>Вопрос</h2>
                <form action="">
                    <ul class="variant__list">
                        <li class="variant__item">
                            <input type="checkbox" name="var1" id="checkbox-1">
                            <label for="checkbox-1" type="checkbox">Вариант</label>
                        </li>
                        <li class="variant__item">
                            <input type="checkbox" name="var1" id="checkbox-2">
                            <label for="checkbox-2" type="checkbox">Вариант</label>
                        </li>
                        <li class="variant__item">
                            <input type="checkbox" name="var1" id="checkbox-3">
                            <label for="checkbox-3" type="checkbox">Вариант</label>
                        </li>
                    </ul>
                </form>
            </li>
            <li class="question__item question__item_selective">
                <h2>Вопрос</h2>
                <form action="">
                    <ul class="variant__list">
                        <li class="variant__item">
                            <input type="radio" name="var2" id="radio-1">
                            <label for="radio-1" type="radio">Вариант</label>
                        </li>
                        <li class="variant__item">
                            <input type="radio" name="var2" id="radio-2">
                            <label for="radio-2" type="radio">Вариант</label>
                        </li>
                        <li class="variant__item">
                            <input type="radio" name="var2" id="radio-3">
                            <label for="radio-3" type="radio">Вариант</label>
                        </li>
                    </ul>
                    
                </form>

            </li>
            <li class="question__item question__item_textarea">
                <h2>Вопрос</h2>
                <form action="">
                    <ul class="variant__list">
                        <li class="variant__item">
                            <p>Введите ответ</p>
                            <br>
                            <textarea name=""></textarea>
                        </li>
                    </ul>
                </form>
            </li>
        </ol>
        <div class="variant__buttons"><button class="variant__answer" onclick="javascript:myFunction()">Ответить</button></div>
    </main>
    <script>
        
        function myFunction() {
            let TestData = [];
            let question_count = 0;
            const questions = document.getElementsByClassName("question__list");
            for (let i=0; i < questions.length; i+=1) {
                let question = questions[i];
                let question_answers = [];
                console.log(question);
                if (question.classList.contains("question__item_selective"))
                {
                    let options = question.getElementsByTagName("form")[0].getElementsByTagName("ul")[0].children;
                    for (let j=0; j<options.length; j++)
                    {
                        let option = options[j];
                        let checkbox = option.getElementsByTagName("input")[0];
                        if (checkbox.checked)
                        {
                            question_answers.push(j.toString());
                        }
                    };
                    let obj = {
                        "questionId": question_count.toString(),
                        "answer": question_answers
                    }
                    TestData.push(obj);
                }
                else if (question.classList.contains("question__item_textarea"))
                {
                    let textfield = question.getElementsByTagName("form")[0].getElementsByTagName("ul")[0].children[0].getElementsByTagName("textarea");
                    
                    let obj = {
                        "questionId": question_count.toString(),
                        "answer": [textfield.value]
                    }
                    TestData.push(obj);
                }
                question_count+=1;
            }
            console.log(TestData);
        }
    </script>
</body>
</html>